@page "/Arvinger"

<div class="HeirContainer">
    <div class="TopContainer">
        <h1>Indtast dine arvinger</h1>
    </div>
    <div class="SelectorContainer">
        @foreach (var heir in HeirsRepository.Heirs)
        {
            <div class="Selector">
                <HeirSelectorComponent Heir="heir" OnClose="HandleClose"/>
            </div>
        }
        
        <div class="Selector" id="ButtonBox">
            <button class="AddButton" @onclick="AddHeir">Tilf√∏j flere (+)</button>
        </div>
    </div>
</div>
@code {
    private List<Heir> HeirsList { get; set; } = HeirsRepository.Heirs; 
    private List<Testator> testatorList { get; set; } = TestatorRepository.testators;

    private void AddHeir()
    {
        HeirsRepository.AddHeir(new Heir());
        HeirsList = HeirsRepository.Heirs; 
        StateHasChanged(); 
    }

    private void RemoveHeir(Heir heir)
    {
        if (heir != null)
        {
            HeirsRepository.RemoveHeir(heir.Id);

            foreach (var testator in testatorList)
            {
                if (testator.Heirs.Any(h => h.Id == heir.Id))
                {
                    testator.Heirs.Remove(heir);
                }
            }
        }
    }

    private void HandleClose(Heir heir)
    {
        RemoveHeir(heir);
    }
}
